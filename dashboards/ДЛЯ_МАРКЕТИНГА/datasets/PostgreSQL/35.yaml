table_name: "\u0413\u0435\u043E\u0433\u0440\u0430\u0444\u0438\u044F \u043A\u043B\u0438\
  \u0435\u043D\u0442\u043E\u0432 \u043F\u043E \u0433\u043E\u0440\u043E\u0434\u0430\
  \u043C"
main_dttm_col: null
description: null
default_endpoint: null
offset: 0
cache_timeout: null
catalog: olist_db
schema: public
sql: "WITH geo_avg AS (\n  SELECT\n    geolocation_zip_code_prefix,\n    -- \u041D\
  \u0430\u0445\u043E\u0434\u0438\u043C \u0441\u0440\u0435\u0434\u043D\u044E\u044E\
  \ \u0448\u0438\u0440\u043E\u0442\u0443 \u0434\u043B\u044F \u043A\u0430\u0436\u0434\
  \u043E\u0433\u043E \u0443\u043D\u0438\u043A\u0430\u043B\u044C\u043D\u043E\u0433\u043E\
  \ \u0438\u043D\u0434\u0435\u043A\u0441\u0430\n    AVG(geolocation_lat) AS avg_lat,\n\
  \    -- \u041D\u0430\u0445\u043E\u0434\u0438\u043C \u0441\u0440\u0435\u0434\u043D\
  \u044E\u044E \u0434\u043E\u043B\u0433\u043E\u0442\u0443 \u0434\u043B\u044F \u043A\
  \u0430\u0436\u0434\u043E\u0433\u043E \u0443\u043D\u0438\u043A\u0430\u043B\u044C\u043D\
  \u043E\u0433\u043E \u0438\u043D\u0434\u0435\u043A\u0441\u0430\n    AVG(geolocation_lng)\
  \ AS avg_lng\n  FROM\n    geolocation \n  GROUP BY\n    geolocation_zip_code_prefix\n\
  )\n-- \u0428\u0430\u0433 2: \u0422\u0435\u043F\u0435\u0440\u044C \u0441\u043E\u0435\
  \u0434\u0438\u043D\u044F\u0435\u043C \u043A\u043B\u0438\u0435\u043D\u0442\u043E\u0432\
  \ \u0441 \u0447\u0438\u0441\u0442\u044B\u043C\u0438 \u043A\u043E\u043E\u0440\u0434\
  \u0438\u043D\u0430\u0442\u0430\u043C\u0438 \u0438 \u0441\u0447\u0438\u0442\u0430\
  \u0435\u043C \u0438\u0445 \u043A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\
  \u043E\nSELECT\n  c.customer_city,\n  c.customer_state,\n  -- \u041D\u0430\u0445\
  \u043E\u0434\u0438\u043C \u0441\u0440\u0435\u0434\u043D\u0438\u0435 \u043A\u043E\
  \u043E\u0440\u0434\u0438\u043D\u0430\u0442\u044B \u0434\u043B\u044F \u0433\u043E\
  \u0440\u043E\u0434\u0430, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u0441\u0442\
  \u0430\u0432\u0438\u0442\u044C \u043E\u0434\u043D\u0443 \u0442\u043E\u0447\u043A\
  \u0443 \u043D\u0430 \u0433\u043E\u0440\u043E\u0434\n  AVG(g.avg_lat) AS latitude,\n\
  \  AVG(g.avg_lng) AS longitude,\n  -- \u0421\u0447\u0438\u0442\u0430\u0435\u043C\
  \ \u043A\u043E\u043B\u0438\u0447\u0435\u0441\u0442\u0432\u043E \u0443\u043D\u0438\
  \u043A\u0430\u043B\u044C\u043D\u044B\u0445 \u043A\u043B\u0438\u0435\u043D\u0442\u043E\
  \u0432 \u0432 \u044D\u0442\u043E\u043C \u0433\u043E\u0440\u043E\u0434\u0435\n  COUNT(DISTINCT\
  \ c.customer_unique_id) AS customer_count\nFROM\n  customers AS c\n  -- \u041F\u0440\
  \u0438\u0441\u043E\u0435\u0434\u0438\u043D\u044F\u0435\u043C \u043D\u0430\u0448\u0443\
  \ \u0432\u0440\u0435\u043C\u0435\u043D\u043D\u0443\u044E \u0442\u0430\u0431\u043B\
  \u0438\u0446\u0443 \u043F\u043E \u0438\u043D\u0434\u0435\u043A\u0441\u0443\nJOIN\n\
  \  geo_avg AS g ON c.customer_zip_code_prefix = g.geolocation_zip_code_prefix\n\
  -- \u0413\u0440\u0443\u043F\u043F\u0438\u0440\u0443\u0435\u043C \u0432\u0441\u0451\
  \ \u043F\u043E \u0448\u0442\u0430\u0442\u0443 \u0438 \u0433\u043E\u0440\u043E\u0434\
  \u0443, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u043B\u0443\u0447\u0438\u0442\
  \u044C \u0438\u0442\u043E\u0433\u043E\u0432\u044B\u0435 \u0446\u0438\u0444\u0440\
  \u044B\nGROUP BY\n  c.customer_state,\n  c.customer_city"
params: null
template_params: null
filter_select_enabled: true
fetch_values_predicate: null
extra: null
normalize_columns: false
always_filter_main_dttm: false
uuid: 51c4007d-441a-4d3b-bcb0-d8410a72caf0
metrics:
- metric_name: count
  verbose_name: COUNT(*)
  metric_type: count
  expression: COUNT(*)
  description: null
  d3format: null
  currency: null
  extra: null
  warning_text: null
columns:
- column_name: latitude
  verbose_name: null
  is_dttm: false
  is_active: true
  type: DECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: null
- column_name: longitude
  verbose_name: null
  is_dttm: false
  is_active: true
  type: DECIMAL
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: null
- column_name: customer_count
  verbose_name: null
  is_dttm: false
  is_active: true
  type: LONGINTEGER
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: null
- column_name: customer_state
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: null
- column_name: customer_city
  verbose_name: null
  is_dttm: false
  is_active: true
  type: STRING
  advanced_data_type: null
  groupby: true
  filterable: true
  expression: null
  description: null
  python_date_format: null
  extra: null
version: 1.0.0
database_uuid: 36600231-221d-41fd-b910-1bb35b9465df
